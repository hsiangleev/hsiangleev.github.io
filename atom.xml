<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>李祥的网络日志</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://hsianglee.cn/"/>
  <updated>2019-03-09T02:57:44.951Z</updated>
  <id>https://hsianglee.cn/</id>
  
  <author>
    <name>hsianglee</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>webpack配置react</title>
    <link href="https://hsianglee.cn/2019/03/09/js/webpack%E9%85%8D%E7%BD%AEreact/"/>
    <id>https://hsianglee.cn/2019/03/09/js/webpack配置react/</id>
    <published>2019-03-09T01:45:50.000Z</published>
    <updated>2019-03-09T02:57:44.951Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:57:54 GMT+0800 (GMT+08:00) --><ol><li>初始化package.json<br><code>npm init</code></li><li>安装babel-loader(新版8.0.0报错)<br><code>cnpm install babel-loader@7.1.5 babel-preset-es2015 babel-preset-react --save-dev</code></li><li>安装webpack<br><code>cnpm install webpack webpack-cli webpack-dev-server --save-dev</code></li><li><p>创建webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">var</span> HtmlwebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ROOT_PATH = path.resolve(__dirname);</span><br><span class="line"><span class="keyword">var</span> APP_PATH = path.resolve(ROOT_PATH, <span class="string">'app'</span>);</span><br><span class="line"><span class="keyword">var</span> BUILD_PATH = path.resolve(ROOT_PATH, <span class="string">'build'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports= &#123;</span><br><span class="line">   <span class="comment">// @babel/polyfill兼容ie9,ie10</span></span><br><span class="line">    entry: [<span class="string">"@babel/polyfill"</span>, path.resolve(APP_PATH, <span class="string">'index.jsx'</span>)],</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: BUILD_PATH,</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mode: <span class="string">"development"</span>,</span><br><span class="line">    <span class="comment">// mode: "production",</span></span><br><span class="line">    <span class="comment">//enable dev source map</span></span><br><span class="line">    devtool: <span class="string">'eval-source-map'</span>,</span><br><span class="line">    <span class="comment">//enable dev server</span></span><br><span class="line">    devServer: &#123;</span><br><span class="line">        historyApiFallback: <span class="literal">true</span>,</span><br><span class="line">        hot: <span class="literal">true</span>,</span><br><span class="line">        inline: <span class="literal">true</span>,</span><br><span class="line">        progress: <span class="literal">true</span>,</span><br><span class="line">        port: <span class="number">3000</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//babel重要的loader在这里</span></span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">                loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                include: APP_PATH</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">                loaders: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">&#123;</span><br><span class="line">test: <span class="regexp">/\.(png|jpg|gif|svg)$/</span>,</span><br><span class="line">loader: <span class="string">'file-loader'</span>,</span><br><span class="line">options: &#123; <span class="attr">name</span>: <span class="string">'[name].[ext]?[hash]'</span> &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123; </span><br><span class="line">test: <span class="regexp">/\.(gif|jpg|png|woff|woff2|svg|eot|ttf)\??.*$/</span>, </span><br><span class="line">loader: <span class="string">'url-loader?limit=50000&amp;name=[path][name].[ext]'</span></span><br><span class="line">&#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">'*'</span>, <span class="string">'.js'</span>, <span class="string">'.jsx'</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlwebpackPlugin(&#123;</span><br><span class="line">            title: <span class="string">'My first react app'</span>,</span><br><span class="line">            template: <span class="string">"index.html"</span>,</span><br><span class="line">            filename: <span class="string">"index.html"</span>,</span><br><span class="line">            inject: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>npm中添加webpack启动命令</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"dev"</span>: <span class="string">"webpack-dev-server --progress --profile --colors --hot"</span>,</span><br><span class="line"><span class="string">"build"</span>: <span class="string">"webpack --progress --profile --colors"</span>,</span><br><span class="line"><span class="string">"test"</span>: <span class="string">"karma start"</span></span><br></pre></td></tr></table></figure></li><li><p>安装React和React-Dom<br><code>cnpm install react react-dom --save</code></p></li><li>应用中使用sass<br><code>cnpm install css-loader style-loader sass-loader node-sass --save-dev</code></li><li><p>创建 .babelrc文件，babel分离</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"presets"</span>: [<span class="string">"react"</span>, <span class="string">"es2015"</span>],</span><br><span class="line">    <span class="string">"env"</span>: &#123;</span><br><span class="line">        <span class="string">"development"</span>: &#123;</span><br><span class="line">            <span class="string">"presets"</span>: [<span class="string">"react-hmre"</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>安装其他loader<br><code>cnpm install html-webpack-plugin file-loader babel-core url-loader babel-preset-react-hmre @babel/polyfill --save-dev</code></p></li><li><p>loader汇总</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"babel-core"</span>: <span class="string">"^6.26.3"</span>,</span><br><span class="line">    <span class="string">"babel-loader"</span>: <span class="string">"^7.1.5"</span>,</span><br><span class="line">    <span class="string">"babel-preset-es2015"</span>: <span class="string">"^6.24.1"</span>,</span><br><span class="line">    <span class="string">"babel-preset-react"</span>: <span class="string">"^6.24.1"</span>,</span><br><span class="line">    <span class="string">"babel-preset-react-hmre"</span>: <span class="string">"^1.1.1"</span>,</span><br><span class="line">    <span class="string">"css-loader"</span>: <span class="string">"^1.0.0"</span>,</span><br><span class="line">    <span class="string">"file-loader"</span>: <span class="string">"^2.0.0"</span>,</span><br><span class="line">    <span class="string">"html-webpack-plugin"</span>: <span class="string">"^3.2.0"</span>,</span><br><span class="line">    <span class="string">"node-sass"</span>: <span class="string">"^4.9.3"</span>,</span><br><span class="line">    <span class="string">"sass-loader"</span>: <span class="string">"^7.1.0"</span>,</span><br><span class="line">    <span class="string">"style-loader"</span>: <span class="string">"^0.23.0"</span>,</span><br><span class="line">    <span class="string">"url-loader"</span>: <span class="string">"^1.1.1"</span>,</span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"^4.17.1"</span>,</span><br><span class="line">    <span class="string">"webpack-cli"</span>: <span class="string">"^3.1.0"</span>,</span><br><span class="line">    <span class="string">"webpack-dev-server"</span>: <span class="string">"^3.1.7"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"@babel/polyfill"</span>: <span class="string">"^7.2.5"</span>,</span><br><span class="line">    <span class="string">"react"</span>: <span class="string">"^16.8.4"</span>,</span><br><span class="line">    <span class="string">"react-dom"</span>: <span class="string">"^16.8.4"</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>创建index.html模板页<br>title为<code>&lt;title&gt;&lt;%= htmlWebpackPlugin.options.title %&gt;&lt;/title&gt;</code><br>body为<code>&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code></p></li><li><p>创建src文件夹，src文件夹下创建index.jsx</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  element,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>执行命令<code>npm run dev</code>，浏览器打开<a href="http://localhost:3000/" target="_blank" rel="noopener">http://localhost:3000/</a></p></li></ol><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      webpack配置react项目练习
    
    </summary>
    
      <category term="js" scheme="https://hsianglee.cn/categories/js/"/>
    
    
      <category term="js" scheme="https://hsianglee.cn/tags/js/"/>
    
      <category term="react" scheme="https://hsianglee.cn/tags/react/"/>
    
  </entry>
  
  <entry>
    <title>记录未留心的vue细节</title>
    <link href="https://hsianglee.cn/2019/03/06/js/%E6%9C%AA%E7%95%99%E5%BF%83%E7%9A%84vue%E7%BB%86%E8%8A%82/"/>
    <id>https://hsianglee.cn/2019/03/06/js/未留心的vue细节/</id>
    <published>2019-03-06T05:34:26.000Z</published>
    <updated>2019-03-07T06:14:11.877Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><h4 id="vue模板语法"><a href="#vue模板语法" class="headerlink" title="vue模板语法"></a>vue模板语法</h4><hr><ol><li><p>v-once指令<br>通过使用 v-once 指令，你也能执行一次性地插值，当数据改变时，插值处的内容不会更新。<br><code>&lt;span v-once&gt;这个将不会改变: &lt;/span&gt;</code></p></li><li><p>动态参数（2.6.0 新增）<br>可以用方括号括起来的 JavaScript 表达式作为一个指令的参数，即节点属性可以动态设置<br><code>&lt;a v-bind:[attributeName]=&quot;url&quot;&gt; ... &lt;/a&gt;</code><br><code>&lt;a v-on:[eventName]=&quot;doSomething&quot;&gt; ... &lt;/a&gt;</code></p></li></ol><h4 id="计算属性和侦听器"><a href="#计算属性和侦听器" class="headerlink" title="计算属性和侦听器"></a>计算属性和侦听器</h4><hr><ol><li>计算属性（对于任何复杂逻辑，都应当使用计算属性）<ul><li>如果计算属性的依赖属性发生改变，则计算属性也会相应改变</li><li>计算属性是基于它们的依赖进行缓存的，只在相关依赖发生改变时它们才会重新求值</li></ul></li></ol><h4 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h4><hr><ol><li><p>在 template 元素上使用 v-if 条件渲染分组，而不需要多加一层div<br>因为 v-if 是一个指令，所以必须将它添加到一个元素上。但是如果想切换多个元素，此时可以把一个 template 元素当做不可见的包裹元素，并在上面使用 v-if。最终的渲染结果将不包含 template 元素。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"ok"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>用 key 管理可复用的元素<br>Vue 会尽可能高效地渲染元素，通常会复用已有元素而不是从头开始渲染。所以使用v-if切换input的时候已经输入的input值不会清除，所以添加一个具有唯一值的 key 属性代表这两个元素是完全独立的，不要复用它们。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"loginType === 'username'"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"Enter your username"</span> <span class="attr">key</span>=<span class="string">"username-input"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">placeholder</span>=<span class="string">"Enter your email address"</span> <span class="attr">key</span>=<span class="string">"email-input"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h4><hr><ol><li><p>v-for遍历对象</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- value, key, index分别代表 值, 键, 索引 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"(value, key, index) in object"</span>&gt;</span></span><br><span class="line">    &#123;&#123; index &#125;&#125;. &#123;&#123; key &#125;&#125;: &#123;&#123; value &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>数组更新检测<br>由于 JavaScript 的限制，Vue 不能检测以下变动的数组：</p><ul><li>当你利用索引直接设置一个项时，例如：vm.items[indexOfItem] = newValue</li><li><p>当你修改数组的长度时，例如：vm.items.length = newLength</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">data: &#123;</span><br><span class="line">    items: [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">vm.items[<span class="number">1</span>] = <span class="string">'x'</span> <span class="comment">// 不是响应性的</span></span><br><span class="line">vm.items.length = <span class="number">2</span> <span class="comment">// 不是响应性的</span></span><br></pre></td></tr></table></figure></li><li><p>为了解决第一类问题，以下两种方式都可以实现和 <code>vm.items[indexOfItem] = newValue</code> 相同的效果，同时也将触发状态更新：<br><code>Vue.set(vm.items, indexOfItem, newValue)</code><br><code>vm.items.splice(indexOfItem, 1, newValue)</code></p></li><li>为了解决第二类问题，你可以使用 splice：<br><code>vm.items.splice(newLength)</code></li></ul></li><li><p>对象更改检测注意事项<br>由于 JavaScript 的限制，Vue 不能检测对象属性的添加或删除：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    data: &#123;</span><br><span class="line">        person: &#123;</span><br><span class="line">            a: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// `vm.person.a` 现在是响应式的</span></span><br><span class="line"></span><br><span class="line">vm.person.b = <span class="number">2</span></span><br><span class="line"><span class="comment">// `vm.person.b` 不是响应式的</span></span><br></pre></td></tr></table></figure><p>可以使用 vm.$set 实例方法，它只是全局 Vue.set 的别名：<br><code>vm.$set(vm.person, &#39;b&#39;, 2)</code></p></li></ol><h4 id="表单输入绑定-值绑定"><a href="#表单输入绑定-值绑定" class="headerlink" title="表单输入绑定(值绑定)"></a>表单输入绑定(值绑定)</h4><hr><ol><li><p>复选框</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">"checkbox"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-model</span>=<span class="string">"toggle"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">true-value</span>=<span class="string">"yes"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">false-value</span>=<span class="string">"no"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br></pre></td></tr></table></figure><p>被选中时toggle为yes, 即<code>vm.toggle === &#39;yes&#39;</code>, 未被选中时为no, 即<code>vm.toggle === &#39;no&#39;</code></p></li><li><p>单选按钮<br><code>&lt;input type=&quot;radio&quot; v-model=&quot;pick&quot; v-bind:value=&quot;a&quot;&gt;</code><br>即<code>vm.pick===vm.a</code></p></li><li><p>选择框的选项</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">v-bind:value</span>=<span class="string">"&#123; number: 123 &#125;"</span>&gt;</span>123<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当选中时</span></span><br><span class="line"><span class="keyword">typeof</span> vm.selected <span class="comment">// =&gt; 'object'</span></span><br><span class="line">vm.selected.number <span class="comment">// =&gt; 123</span></span><br></pre></td></tr></table></figure></li></ol><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      再次阅读vue文档,看到了许多以前忽略的细节,这次把它们记录下来
    
    </summary>
    
      <category term="js" scheme="https://hsianglee.cn/categories/js/"/>
    
    
      <category term="js" scheme="https://hsianglee.cn/tags/js/"/>
    
      <category term="vue" scheme="https://hsianglee.cn/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>js选中文本和复制文本</title>
    <link href="https://hsianglee.cn/2019/03/01/js/js%E9%80%89%E4%B8%AD%E6%96%87%E6%9C%AC%E4%B8%8E%E5%A4%8D%E5%88%B6%E6%96%87%E6%9C%AC/"/>
    <id>https://hsianglee.cn/2019/03/01/js/js选中文本与复制文本/</id>
    <published>2019-03-01T08:16:12.000Z</published>
    <updated>2019-03-01T08:53:50.780Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><h3 id="Selection"><a href="#Selection" class="headerlink" title="Selection"></a>Selection</h3><hr><p><code>var selection = window.getSelection();</code><br>selection 是一个 Selection 对象。 如果想要将 selection 转换为字符串，可通过连接一个空字符串（””）或使用 String.toString() 方法。即<code>selection+&quot;&quot;</code>或者<code>selection.toString()</code>会返回页面中选中的文本</p><h3 id="Range"><a href="#Range" class="headerlink" title="Range"></a>Range</h3><hr><p>被选中的文字会对应一个range对象，代表选中的区域，通过<code>window.getSelection().getRangeAt(0)</code>代表第一个被选中的区域，也可以通过<code>document.createRange()</code>创建一个选中区域，<code>range.selectNodeContents(el)</code>将dom节点添加到range对象，<code>selection.addRange(range)</code>将range添加到文本选中区，<code>selection.removeAllRanges()</code>为取消选中的文本。执行下面的代码会选中页面的第一个p元素。<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> el = <span class="built_in">document</span>.querySelector(<span class="string">"p"</span>);</span><br><span class="line"><span class="keyword">var</span> selection = <span class="built_in">window</span>.getSelection();</span><br><span class="line"><span class="keyword">var</span> range = <span class="built_in">document</span>.createRange();</span><br><span class="line">range.selectNodeContents(el);</span><br><span class="line">selection.addRange(range);</span><br></pre></td></tr></table></figure><p></p><h3 id="execCommand-方法允许运行命令来操纵可编辑内容区域的元素。"><a href="#execCommand-方法允许运行命令来操纵可编辑内容区域的元素。" class="headerlink" title="execCommand 方法允许运行命令来操纵可编辑内容区域的元素。"></a>execCommand 方法允许运行命令来操纵可编辑内容区域的元素。</h3><hr><p><code>bool = document.execCommand(aCommandName, aShowDefaultUI, aValueArgument);</code></p><ol><li>aCommandName: 一个 DOMString ，命令的名称。</li><li>aShowDefaultUI: 一个 Boolean， 是否展示用户界面，一般为 false。</li><li>aValueArgument: 一些命令（例如insertImage）需要额外的参数（insertImage需要提供插入image的url），默认为null。</li><li>返回值bool为布尔值，如果是 false 则表示操作不被支持或未被启用，执行<code>document.execCommand(&#39;Copy&#39;, &#39;false&#39;, null);</code>会复制页面选中的文本</li></ol><h3 id="示例（点击按钮复制p文本内容）"><a href="#示例（点击按钮复制p文本内容）" class="headerlink" title="示例（点击按钮复制p文本内容）"></a>示例（点击按钮复制p文本内容）</h3><hr><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 页面dom元素</span></span><br><span class="line">&lt;p&gt;aaa&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;button&gt;复制&lt;/</span>button&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// js代码</span></span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">"button"</span>).onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> el = <span class="built_in">document</span>.querySelector(<span class="string">"p"</span>);</span><br><span class="line">    <span class="keyword">var</span> selection = <span class="built_in">window</span>.getSelection();</span><br><span class="line">    <span class="keyword">var</span> range = <span class="built_in">document</span>.createRange();</span><br><span class="line">    range.selectNodeContents(el);</span><br><span class="line">    selection.removeAllRanges();</span><br><span class="line">    selection.addRange(range);</span><br><span class="line">    <span class="built_in">document</span>.execCommand(<span class="string">'Copy'</span>, <span class="string">'false'</span>, <span class="literal">null</span>);</span><br><span class="line">    selection.removeAllRanges();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      通过js代码选中页面的dom元素，和复制页面选中的文本
    
    </summary>
    
      <category term="js" scheme="https://hsianglee.cn/categories/js/"/>
    
    
      <category term="js" scheme="https://hsianglee.cn/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>基于layui的tree组件</title>
    <link href="https://hsianglee.cn/2019/02/28/js/eleTree/"/>
    <id>https://hsianglee.cn/2019/02/28/js/eleTree/</id>
    <published>2019-02-28T06:23:05.000Z</published>
    <updated>2019-03-01T08:16:20.724Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><p style="font-size:18px;font-weight:500;text-indent:2em">因公司使用的是layui框架，而layui的树组件实现的功能太少，所以便想着自己实现一个，顺便练练手，期间因逻辑混乱代码重构过一次。</p><h4 id="插件整体思路"><a href="#插件整体思路" class="headerlink" title="插件整体思路"></a>插件整体思路</h4><ol><li>对外仅暴漏出eleTree接口，eleTree有两个方法，on方法是layui封装的事件机制，render方法为初始化，调用render方法时，初始化树,生成实例对象</li><li>thisTree为实例对象上对外的方法</li><li>Class为真正的构造函数，主体结构如下：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> eleTree=&#123;</span><br><span class="line">    on: <span class="function"><span class="keyword">function</span>(<span class="params">events, callback</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> layui.onevent.call(<span class="keyword">this</span>, MOD_NAME, events, callback);</span><br><span class="line">    &#125;,</span><br><span class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> inst = <span class="keyword">new</span> Class(options);</span><br><span class="line">        <span class="keyword">return</span> thisTree.call(inst);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> thisTree=<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _self=<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> options = _self.config;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 暴漏外面的方法</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        append: <span class="function"><span class="keyword">function</span>(<span class="params">key,data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(options.data.length===<span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">return</span> _self.append.call(_self,key,data);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Class=<span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line">Class.prototype=&#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Class,</span><br><span class="line">    append: function(key,data) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h4 id="代码执行过程"><a href="#代码执行过程" class="headerlink" title="代码执行过程"></a>代码执行过程</h4><ol><li>当调用<code>var el=eleTree.render({})</code>的时候调用Class构造函数初始化树，执行<code>thisTree.call(inst);</code>，即执行thisTree函数，函数内部的this为inst实例对象，然后返回一个包含多个方法的对象</li><li>所以返回值el为包含多个方法的对象</li><li>当调用<code>el.append()</code>方法时，执行inst实例对象的append方法，即执行Class原型链上的append方法，append方法内部this还是inst实例对象</li></ol><p><a href="https://layuiextend.hsianglee.cn/eletree/" target="_blank" rel="noopener">在线文档</a><br><a href="https://layuiextend.hsianglee.cn/eletree/test.html" target="_blank" rel="noopener">在线示例</a><br><a href="https://github.com/hsiangleev/layuiExtend" target="_blank" rel="noopener">github源码</a></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      仿照elementUI接口实现的基于layui的树组件
    
    </summary>
    
      <category term="js" scheme="https://hsianglee.cn/categories/js/"/>
    
    
      <category term="layui" scheme="https://hsianglee.cn/tags/layui/"/>
    
      <category term="js" scheme="https://hsianglee.cn/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>添加图片放大效果和桃心效果</title>
    <link href="https://hsianglee.cn/2019/02/12/hexo%E9%85%8D%E7%BD%AE/%E5%9B%BE%E7%89%87%E6%94%BE%E5%A4%A7%E6%95%88%E6%9E%9C%E5%92%8C%E6%A1%83%E5%BF%83%E6%95%88%E6%9E%9C/"/>
    <id>https://hsianglee.cn/2019/02/12/hexo配置/图片放大效果和桃心效果/</id>
    <published>2019-02-12T06:57:30.000Z</published>
    <updated>2019-02-20T09:28:05.144Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><h3 id="添加图片放大效果和滚动缩放效果"><a href="#添加图片放大效果和滚动缩放效果" class="headerlink" title="添加图片放大效果和滚动缩放效果"></a>添加图片放大效果和滚动缩放效果</h3><hr><ul><li>找到主题文件夹下的目录<code>/source/js/src/post-details.js</code></li><li><p>添加下面代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 图片放大</span></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="built_in">document</span>.body).append(<span class="string">'&lt;div class="lee-increase"&gt;&lt;img src=""&gt;&lt;/div&gt;'</span>);</span><br><span class="line">    <span class="keyword">var</span> isShow=<span class="literal">false</span>;</span><br><span class="line">    $(<span class="string">".post-body img"</span>).on(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> src=$(<span class="keyword">this</span>).attr(<span class="string">"src"</span>);</span><br><span class="line">        <span class="keyword">var</span> alt=$(<span class="keyword">this</span>).attr(<span class="string">"alt"</span>);</span><br><span class="line">        $(<span class="string">".lee-increase"</span>).show().children(<span class="string">"img"</span>).attr(<span class="string">"src"</span>, src).attr(<span class="string">"alt"</span>,alt).width(<span class="string">"auto"</span>);</span><br><span class="line">        $(<span class="built_in">document</span>.body).css(<span class="string">"overflow"</span>,<span class="string">"hidden"</span>);</span><br><span class="line">        isShow=<span class="literal">true</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    $(<span class="string">".lee-increase"</span>).on(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="keyword">this</span>).hide();</span><br><span class="line">        $(<span class="built_in">document</span>.body).css(<span class="string">"overflow"</span>,<span class="string">"auto"</span>);</span><br><span class="line">        isShow=<span class="literal">false</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 鼠标滚动放大缩小</span></span><br><span class="line">    $(<span class="built_in">document</span>).on(<span class="string">'mousewheel DOMMouseScroll'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!isShow) <span class="keyword">return</span>;</span><br><span class="line">        e.preventDefault();</span><br><span class="line">        <span class="keyword">var</span> wheel = e.originalEvent.wheelDelta || -e.originalEvent.detail;</span><br><span class="line">        <span class="keyword">var</span> delta = <span class="built_in">Math</span>.max(<span class="number">-1</span>, <span class="built_in">Math</span>.min(<span class="number">1</span>, wheel) );</span><br><span class="line">        <span class="keyword">var</span> w=$(<span class="string">".lee-increase img"</span>).width();</span><br><span class="line">            <span class="keyword">if</span>(delta&lt;<span class="number">0</span>)&#123;<span class="comment">//向下滚动</span></span><br><span class="line">            $(<span class="string">".lee-increase img"</span>).width(w+<span class="number">50</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//向上滚动</span></span><br><span class="line">            $(<span class="string">".lee-increase img"</span>).width(w<span class="number">-50</span>);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>找到主题文件夹下的目录<code>/source/css/_custom/custom.styl</code></p></li><li>添加下面代码<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 图片放大</span></span><br><span class="line">.post-body img&#123;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    cursor: zoom-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br><span class="line">.lee-increase&#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    top: <span class="number">0</span>;</span><br><span class="line">    left: <span class="number">0</span>;</span><br><span class="line">    width: <span class="number">100</span>%;</span><br><span class="line">    height: <span class="number">100</span>%;</span><br><span class="line">    background-color: #333;</span><br><span class="line">    background-color: #333c;</span><br><span class="line">    z-index: <span class="number">99999</span>;</span><br><span class="line">    display: none;</span><br><span class="line">    &amp;&gt;img&#123;</span><br><span class="line">        max-width: <span class="number">90</span>%;</span><br><span class="line">        min-width: <span class="number">20</span>%;</span><br><span class="line">        position: absolute;</span><br><span class="line">        top: <span class="number">50</span>%;</span><br><span class="line">        left: <span class="number">50</span>%;</span><br><span class="line">        cursor: pointer;</span><br><span class="line">        cursor: zoom-out;</span><br><span class="line">        transform: translate(<span class="number">-50</span>%, <span class="number">-50</span>%);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="点击出现桃心效果"><a href="#点击出现桃心效果" class="headerlink" title="点击出现桃心效果"></a>点击出现桃心效果</h3><hr><ul><li>在post-details.js后面继续添加代码<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">e,t,a</span>)</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params"></span>)</span>&#123;c(<span class="string">".heart&#123;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);&#125;.heart:after,.heart:before&#123;content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;&#125;.heart:after&#123;top: -5px;&#125;.heart:before&#123;left: -5px;&#125;"</span>),o(),r()&#125;<span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params"></span>)</span>&#123;<span class="keyword">for</span>(<span class="keyword">var</span> e=<span class="number">0</span>;e&lt;d.length;e++)d[e].alpha&lt;=<span class="number">0</span>?(t.body.removeChild(d[e].el),d.splice(e,<span class="number">1</span>)):(d[e].y--,d[e].scale+=<span class="number">.004</span>,d[e].alpha-=<span class="number">.013</span>,d[e].el.style.cssText=<span class="string">"left:"</span>+d[e].x+<span class="string">"px;top:"</span>+d[e].y+<span class="string">"px;opacity:"</span>+d[e].alpha+<span class="string">";transform:scale("</span>+d[e].scale+<span class="string">","</span>+d[e].scale+<span class="string">") rotate(45deg);background:"</span>+d[e].color+<span class="string">";z-index:99999"</span>);requestAnimationFrame(r)&#125;<span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> t=<span class="string">"function"</span>==<span class="keyword">typeof</span> e.onclick&amp;&amp;e.onclick;e.onclick=<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;t&amp;&amp;t(),i(e)&#125;&#125;<span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> a=t.createElement(<span class="string">"div"</span>);a.className=<span class="string">"heart"</span>,d.push(&#123;<span class="attr">el</span>:a,<span class="attr">x</span>:e.clientX<span class="number">-5</span>,<span class="attr">y</span>:e.clientY<span class="number">-5</span>,<span class="attr">scale</span>:<span class="number">1</span>,<span class="attr">alpha</span>:<span class="number">1</span>,<span class="attr">color</span>:s()&#125;),t.body.appendChild(a)&#125;<span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">e</span>)</span>&#123;<span class="keyword">var</span> a=t.createElement(<span class="string">"style"</span>);a.type=<span class="string">"text/css"</span>;<span class="keyword">try</span>&#123;a.appendChild(t.createTextNode(e))&#125;<span class="keyword">catch</span>(t)&#123;a.styleSheet.cssText=e&#125;t.getElementsByTagName(<span class="string">"head"</span>)[<span class="number">0</span>].appendChild(a)&#125;<span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span><span class="string">"rgb("</span>+~~(<span class="number">255</span>*<span class="built_in">Math</span>.random())+<span class="string">","</span>+~~(<span class="number">255</span>*<span class="built_in">Math</span>.random())+<span class="string">","</span>+~~(<span class="number">255</span>*<span class="built_in">Math</span>.random())+<span class="string">")"</span>&#125;<span class="keyword">var</span> d=[];e.requestAnimationFrame=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;setTimeout(e,<span class="number">1e3</span>/<span class="number">60</span>)&#125;&#125;(),n()&#125;(<span class="built_in">window</span>,<span class="built_in">document</span>);</span><br></pre></td></tr></table></figure></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      给hexo文章中的图片添加点击放大，滚动缩放效果，和点击页面出现桃心特效
    
    </summary>
    
      <category term="hexo配置" scheme="https://hsianglee.cn/categories/hexo%E9%85%8D%E7%BD%AE/"/>
    
    
      <category term="hexo图片放大" scheme="https://hsianglee.cn/tags/hexo%E5%9B%BE%E7%89%87%E6%94%BE%E5%A4%A7/"/>
    
      <category term="hexo桃心效果" scheme="https://hsianglee.cn/tags/hexo%E6%A1%83%E5%BF%83%E6%95%88%E6%9E%9C/"/>
    
  </entry>
  
  <entry>
    <title>自定义域名解析和安装SSL证书</title>
    <link href="https://hsianglee.cn/2019/02/11/hexo%E9%85%8D%E7%BD%AE/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/"/>
    <id>https://hsianglee.cn/2019/02/11/hexo配置/自定义域名解析/</id>
    <published>2019-02-11T08:42:30.000Z</published>
    <updated>2019-02-20T09:33:22.441Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><h3 id="自定义域名解析"><a href="#自定义域名解析" class="headerlink" title="自定义域名解析"></a>自定义域名解析</h3><hr><p><strong>1. 申请域名</strong><br>我是直接在阿里云购买的.xyz为后缀的域名，<a href="https://wanwang.aliyun.com/domain/" target="_blank" rel="noopener">阿里云域名购买</a>。</p><p><strong>2. 添加DNS解析</strong></p><ul><li>进入<a href="https://dns.console.aliyun.com/#/dns/domainList" target="_blank" rel="noopener">阿里云域名解析</a>，可以看到当前购买的域名<img data-original="/images/自定义域名解析/1.png" class="lazy" alt="自定义域名解析"></li><li>点击域名进入域名解析界面<img data-original="/images/自定义域名解析/2.png" class="lazy" alt="自定义域名解析"></li><li>点击添加记录弹出窗口<img data-original="/images/自定义域名解析/3.png" class="lazy" alt="自定义域名解析"></li><li>添加下图的三项记录<img data-original="/images/自定义域名解析/4.png" class="lazy" alt="自定义域名解析"></li></ul><p><strong>3. 添加CNAME文件</strong></p><ul><li>在hexo根目录的source目录新建文件，名为CNAME(无后缀名)，文件内容为域名地址，我的是hsianglee.xyz，所以在文件内直接输入hsianglee.xyz并保存。</li><li>部署hexo网站<code>hexo d -g</code>。</li><li>过几分钟之后再访问域名应该就可以了</li></ul><h3 id="安装SSL证书，使用https访问网站"><a href="#安装SSL证书，使用https访问网站" class="headerlink" title="安装SSL证书，使用https访问网站"></a>安装SSL证书，使用https访问网站</h3><hr><p><strong>1. 证书购买</strong></p><ul><li><a href="https://common-buy.aliyun.com/?spm=5176.2020520154.cas.1.6bcaIrtbIrtbCy&amp;commodityCode=cas#/buy" target="_blank" rel="noopener">网址</a></li><li>选择Symantec购买免费版<img data-original="/images/自定义域名解析/5.png" class="lazy" alt="自定义域名解析"></li><li>购买完成后跳到<a href="https://yundunnext.console.aliyun.com/?spm=a2c1d.8251892.aliyun_sidebar.12.c99f5b76ntHi2S&amp;p=cas#/overview/cn-hangzhou" target="_blank" rel="noopener">SSL证书</a></li></ul><p><strong>2. 申请</strong></p><ul><li>点击申请<img data-original="/images/自定义域名解析/6.png" class="lazy" alt="自定义域名解析">会在右侧弹出<img data-original="/images/自定义域名解析/7.png" class="lazy" alt="自定义域名解析"></li><li>填写完成后点击下一步</li><li><img data-original="/images/自定义域名解析/8.png" class="lazy" alt="自定义域名解析">点击验证之后会自动添加一条域名解析记录，然后点击下面的提交审核。</li><li>审核完成之后会提示为已签发<img data-original="/images/自定义域名解析/9.png" class="lazy" alt="自定义域名解析"></li></ul><p><strong>3. 添加域名解析记录</strong></p><ul><li>在域名解析页面添加四条记录<img data-original="/images/自定义域名解析/10.png" class="lazy" alt="自定义域名解析"></li><li>到github的博客设置里面把Enforce HTTPS 前面的checkbox选中<img data-original="/images/自定义域名解析/11.png" class="lazy" alt="自定义域名解析"></li><li>如果无法选中，则可以删除上面的域名保存之后再重新添加域名，等几分钟之后应该就可以了</li><li>然后使用https访问网站便会出现前面的锁了<img data-original="/images/自定义域名解析/12.png" class="lazy" alt="自定义域名解析"></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      把 github.io 的地址映射到自定义域名，和使用https访问
    
    </summary>
    
      <category term="hexo配置" scheme="https://hsianglee.cn/categories/hexo%E9%85%8D%E7%BD%AE/"/>
    
    
      <category term="域名解析" scheme="https://hsianglee.cn/tags/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/"/>
    
      <category term="ssl证书" scheme="https://hsianglee.cn/tags/ssl%E8%AF%81%E4%B9%A6/"/>
    
  </entry>
  
  <entry>
    <title>mongodb操作命令</title>
    <link href="https://hsianglee.cn/2019/01/29/mongodb/mongodb%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/"/>
    <id>https://hsianglee.cn/2019/01/29/mongodb/mongodb操作命令/</id>
    <published>2019-01-29T02:46:28.000Z</published>
    <updated>2019-01-30T08:39:55.493Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><h3 id="set-更新或添加属性"><a href="#set-更新或添加属性" class="headerlink" title="$set 更新或添加属性"></a>$set 更新或添加属性</h3><hr><p><strong>例</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"A"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"B"</span>,</span><br><span class="line">            <span class="string">"score"</span> : <span class="number">4.0</span>,</span><br><span class="line">            <span class="string">"answers"</span> : [ </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"q"</span> : <span class="number">1.0</span>,</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">0.0</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>添加属性</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$set</span>: &#123;<span class="string">"arr.0.score"</span>: <span class="number">10</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>更新属性</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$set</span>: &#123;<span class="string">"arr.1.score"</span>: <span class="number">10</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"A"</span>,</span><br><span class="line">            <span class="string">"score"</span> : <span class="number">10.0</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"B"</span>,</span><br><span class="line">            <span class="string">"score"</span> : <span class="number">10.0</span>,</span><br><span class="line">            <span class="string">"answers"</span> : [ </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"q"</span> : <span class="number">1.0</span>,</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">0.0</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="unset-删除对象的属性或把数组的其中一项变成null"><a href="#unset-删除对象的属性或把数组的其中一项变成null" class="headerlink" title="$unset 删除对象的属性或把数组的其中一项变成null"></a>$unset 删除对象的属性或把数组的其中一项变成null</h3><hr><p><strong>例</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"A"</span>,</span><br><span class="line">            <span class="string">"score"</span> : <span class="number">5.5</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"B"</span>,</span><br><span class="line">            <span class="string">"score"</span> : <span class="number">4.0</span>,</span><br><span class="line">            <span class="string">"answers"</span> : [ </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"q"</span> : <span class="number">1.0</span>,</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">0.0</span></span><br><span class="line">                &#125;, </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"q"</span> : <span class="number">1.0</span>,</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">0.0</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>删除一个指定的字段</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除arr数组的第一项的score属性</span></span><br><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$unset</span>: &#123;<span class="string">"arr.0.score"</span>: <span class="number">1</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>当匹配到的是数组元素，$unset替换指定的元素为null而不是删除掉指定的元素，此行为保持数组大小和位置不变；</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把数组arr的第二项的answers的第二项的值变为null</span></span><br><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$unset</span>: &#123;<span class="string">"arr.1.answers.1"</span>: <span class="number">1</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"A"</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"item"</span> : <span class="string">"B"</span>,</span><br><span class="line">            <span class="string">"score"</span> : <span class="number">4.0</span>,</span><br><span class="line">            <span class="string">"answers"</span> : [ </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"q"</span> : <span class="number">1.0</span>,</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">0.0</span></span><br><span class="line">                &#125;, </span><br><span class="line">                <span class="literal">null</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="rename-重新命名属性名-不能操作数组"><a href="#rename-重新命名属性名-不能操作数组" class="headerlink" title="$rename 重新命名属性名(不能操作数组)"></a>$rename 重新命名属性名(不能操作数组)</h3><hr><p><strong>例</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"name"</span> : &#123;</span><br><span class="line">        <span class="string">"gge"</span> : <span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$rename</span>: &#123;<span class="string">"name.gge"</span>: <span class="string">"name.age"</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"name"</span> : &#123;</span><br><span class="line">        <span class="string">"age"</span> : <span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="pop-删除数组中的第一个或者最后一个元素-给-pop传递-1会删除第一个元素传递1会删除最后一个元素"><a href="#pop-删除数组中的第一个或者最后一个元素-给-pop传递-1会删除第一个元素传递1会删除最后一个元素" class="headerlink" title="$pop 删除数组中的第一个或者最后一个元素(给$pop传递-1会删除第一个元素传递1会删除最后一个元素)"></a>$pop 删除数组中的第一个或者最后一个元素(给$pop传递-1会删除第一个元素传递1会删除最后一个元素)</h3><hr><p><strong>例</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">1</span>, </span><br><span class="line">        <span class="number">2</span>, </span><br><span class="line">        <span class="number">3</span>, </span><br><span class="line">        <span class="number">4</span>, </span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>删除数组第一个</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$pop</span>: &#123;<span class="string">"arr"</span>: <span class="number">-1</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>删除数组最后一个</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$pop</span>: &#123;<span class="string">"arr"</span>: <span class="number">1</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">2</span>, </span><br><span class="line">        <span class="number">3</span>, </span><br><span class="line">        <span class="number">4</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="pull-删除数组中符合条件的元素"><a href="#pull-删除数组中符合条件的元素" class="headerlink" title="$pull 删除数组中符合条件的元素"></a>$pull 删除数组中符合条件的元素</h3><hr><p><strong>例</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="string">"b"</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="string">"c"</span>: <span class="number">8</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span>: <span class="number">6</span>,</span><br><span class="line">            <span class="string">"b"</span>: <span class="number">7</span>,</span><br><span class="line">            <span class="string">"c"</span>: <span class="number">8</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>删除数组arr中的a&gt;=5的项</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$pull</span>: &#123;<span class="string">"arr"</span>: &#123;<span class="string">"a"</span>: &#123;<span class="attr">$gte</span>: <span class="number">5</span>&#125;&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">5</span>,</span><br><span class="line">            <span class="string">"c"</span> : <span class="number">8</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>使用$elemMatch匹配多个条件</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"c"</span> : [ </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">10</span>,</span><br><span class="line">                    <span class="string">"b"</span> : <span class="number">10</span></span><br><span class="line">                &#125;, </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">15</span>,</span><br><span class="line">                    <span class="string">"b"</span> : <span class="number">15</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"c"</span> : [ </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">20</span>,</span><br><span class="line">                    <span class="string">"b"</span> : <span class="number">20</span></span><br><span class="line">                &#125;, </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">25</span>,</span><br><span class="line">                    <span class="string">"b"</span> : <span class="number">25</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>删除arr数组 中的c数组中 (a=25 &amp;&amp; b=25)</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$pull</span>: &#123;<span class="string">"arr"</span>: &#123;<span class="string">"c"</span>: &#123;<span class="attr">$elemMatch</span>: &#123;<span class="string">"a"</span>: <span class="number">25</span>,<span class="string">"b"</span>:<span class="number">25</span>&#125;&#125;&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"c"</span> : [ </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">10</span>,</span><br><span class="line">                    <span class="string">"b"</span> : <span class="number">10</span></span><br><span class="line">                &#125;, </span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">"a"</span> : <span class="number">15</span>,</span><br><span class="line">                    <span class="string">"b"</span> : <span class="number">15</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="push-向已有的数组末尾加入一个元素"><a href="#push-向已有的数组末尾加入一个元素" class="headerlink" title="$push 向已有的数组末尾加入一个元素"></a>$push 向已有的数组末尾加入一个元素</h3><hr><p><strong>例</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$push</span>: &#123;<span class="string">"arr"</span>: <span class="number">10</span>&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">5</span>, </span><br><span class="line">        <span class="number">10.0</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>使用$position添加到任意位置</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在arr数组第二项插入四项数据</span></span><br><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$push</span>: &#123;<span class="string">"arr"</span>: &#123;<span class="attr">$each</span>: [<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>], <span class="attr">$position</span>: <span class="number">1</span>&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">5</span>, </span><br><span class="line">        <span class="number">15.0</span>, </span><br><span class="line">        <span class="number">16.0</span>, </span><br><span class="line">        <span class="number">17.0</span>, </span><br><span class="line">        <span class="number">18.0</span>, </span><br><span class="line">        <span class="number">10.0</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="sort-数组排序"><a href="#sort-数组排序" class="headerlink" title="$sort 数组排序"></a>$sort 数组排序</h3><hr><p><strong>1为升序排列，-1为降序排列</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">3</span>, </span><br><span class="line">        <span class="number">1</span>, </span><br><span class="line">        <span class="number">5</span>, </span><br><span class="line">        <span class="number">2</span>, </span><br><span class="line">        <span class="number">6</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$push</span>: &#123;<span class="string">"arr"</span>: &#123;<span class="attr">$each</span>: [], <span class="attr">$sort</span>: <span class="number">1</span>&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">1</span>, </span><br><span class="line">        <span class="number">2</span>, </span><br><span class="line">        <span class="number">3</span>, </span><br><span class="line">        <span class="number">5</span>, </span><br><span class="line">        <span class="number">6</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>2. 根据数组的某一项排序</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">5</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">3</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">4</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">5</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据数组arr的a属性升序排列</span></span><br><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$push</span>: &#123;<span class="string">"arr"</span>: &#123;<span class="attr">$each</span>: [], <span class="attr">$sort</span>: &#123;<span class="string">"a"</span>: <span class="number">1</span>&#125;&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">3</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">4</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">5</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">5</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">6</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="slice-数组截取"><a href="#slice-数组截取" class="headerlink" title="$slice 数组截取"></a>$slice 数组截取</h3><hr><p><strong>正数则从前向后，负数从后向前</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">1</span>, </span><br><span class="line">        <span class="number">2</span>, </span><br><span class="line">        <span class="number">3</span>, </span><br><span class="line">        <span class="number">4</span>, </span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 截取数组arr后三位</span></span><br><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$push</span>: &#123;<span class="string">"arr"</span>: &#123;<span class="attr">$each</span>: [], <span class="attr">$slice</span>: <span class="number">-3</span>&#125;&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        <span class="number">3</span>, </span><br><span class="line">        <span class="number">4</span>, </span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="占位符-，更新数组的某一项不确定位置的值"><a href="#占位符-，更新数组的某一项不确定位置的值" class="headerlink" title="占位符$，更新数组的某一项不确定位置的值"></a>占位符$，更新数组的某一项不确定位置的值</h3><hr><p><strong>例1</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">20</span> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 把数组arr值为20的变成10</span></span><br><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>, <span class="string">"arr"</span>: <span class="number">20</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$set</span>: &#123;<span class="string">"arr.$"</span>: NumberInt(<span class="number">10</span>)&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">10</span> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p><strong>例2</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">10</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">20</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">3</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">30</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新数组arr里面属性a为2的，把当前位置的b变成200</span></span><br><span class="line">db.getCollection(<span class="string">'user'</span>).update(</span><br><span class="line">    &#123;<span class="string">"_id"</span>: <span class="number">1.0</span>, <span class="string">"arr.a"</span>: <span class="number">2</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">$set</span>: &#123;<span class="string">"arr.$.b"</span>: NumberInt(<span class="number">200</span>)&#125;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><strong>结果</strong><br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"_id"</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="string">"arr"</span> : [ </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">10</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">200</span></span><br><span class="line">        &#125;, </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"a"</span> : <span class="number">3</span>,</span><br><span class="line">            <span class="string">"b"</span> : <span class="number">30</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --&gt;&lt;h3 id=&quot;set-更新或添加属性&quot;&gt;&lt;a href=&quot;#set-更新或添加属性&quot; class=&quot;headerlink&quot; title=&quot;$set 
      
    
    </summary>
    
      <category term="mongodb" scheme="https://hsianglee.cn/categories/mongodb/"/>
    
    
      <category term="mongodb" scheme="https://hsianglee.cn/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>mongodb安装</title>
    <link href="https://hsianglee.cn/2019/01/29/mongodb/mongodb%E5%AE%89%E8%A3%85/"/>
    <id>https://hsianglee.cn/2019/01/29/mongodb/mongodb安装/</id>
    <published>2019-01-29T02:46:27.000Z</published>
    <updated>2019-01-30T06:44:43.297Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><p><strong>1. 进入mongodb\bin目录 =&gt;cmd</strong></p><p><strong>2. 在mongodb目录创建 \data\db</strong></p><p><strong>3. cmd执行<code>mongod.exe --dbpath=D:\mongodb\data\db</code></strong></p><p><strong>4. 在mongodb目录创建 \data\log</strong></p><p><strong>5. cmd执行 <code>mongod.exe --logpath=D:\mongodb\data\log\mongodb.log</code></strong></p><p><strong>6. 在mongodb目录创建配置文件（mongodb.config）</strong></p><p><strong>7. 配置文件内容</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dbpath=D:\mongodb\data\db</span><br><span class="line">logpath=D:\mongodb\data\<span class="built_in">log</span>\mongodb.log</span><br></pre></td></tr></table></figure><p><strong>8. 执行 <code>mongod.exe --config D:\mongodb\mongodb.config</code></strong></p><p><strong>9. 添加到服务 （servies.msc）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod.exe --dbpath=D:\mongodb\data\db --logpath=D:\mongodb\data\<span class="built_in">log</span>\log.txt --install --serviceName <span class="string">"MongoDB"</span></span><br></pre></td></tr></table></figure><p><strong>10. 开启关闭服务</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net start mongodb</span><br><span class="line">net stop mongodb</span><br><span class="line">sc delete <span class="string">"MongoDB"</span>     <span class="comment"># 删除服务</span></span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;strong&gt;1. 进入mongodb\bin目录 =&amp;gt;cmd&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;2. 在mongodb目录
      
    
    </summary>
    
      <category term="mongodb" scheme="https://hsianglee.cn/categories/mongodb/"/>
    
    
      <category term="mongodb" scheme="https://hsianglee.cn/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>mongodb数据导入导出</title>
    <link href="https://hsianglee.cn/2019/01/29/mongodb/mongodb%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA/"/>
    <id>https://hsianglee.cn/2019/01/29/mongodb/mongodb数据导入导出/</id>
    <published>2019-01-29T02:46:26.000Z</published>
    <updated>2019-01-30T06:43:05.290Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><p><strong>进入mongodb的bin目录</strong></p><p><strong>1. 数据导出</strong></p><ul><li>-d: 数据库名称</li><li>-c: 表名</li><li>-o: 存储路径</li><li>–type: 导出类型</li><li>-f: 导出的数据<br><code>mongoexport -d test -c blog -o G:\users.json --type json -f &quot;_id,data,user&quot;</code></li></ul><p><strong>2. 数据导入</strong></p><ul><li>-d: 数据库名称</li><li>-c: 表名</li><li>–file: 路径</li><li>–type: 导出类型<br><code>mongoimport -d test -c us --file G:\users.json --type json</code></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;strong&gt;进入mongodb的bin目录&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;1. 数据导出&lt;/strong&gt;&lt;/p&gt;&lt;ul&gt;&lt;
      
    
    </summary>
    
      <category term="mongodb" scheme="https://hsianglee.cn/categories/mongodb/"/>
    
    
      <category term="mongodb" scheme="https://hsianglee.cn/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>mongodb加密</title>
    <link href="https://hsianglee.cn/2019/01/29/mongodb/mongodb%E5%8A%A0%E5%AF%86/"/>
    <id>https://hsianglee.cn/2019/01/29/mongodb/mongodb加密/</id>
    <published>2019-01-29T02:46:25.000Z</published>
    <updated>2019-01-30T06:39:01.176Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><p><strong>1. 切换到admin数据库</strong></p><p><code>use admin</code></p><p><strong>2. 管理员设置密码</strong></p><p><code>db.createUser({user: &quot;root&quot;,pwd: &quot;123&quot;,roles: [&quot;root&quot;]})</code></p><p><strong>3. 验证是否成功</strong></p><p><code>db.auth(&quot;root&quot;,&quot;123&quot;)</code></p><p><strong>4. 给其它数据库添加用户</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use <span class="built_in">test</span></span><br><span class="line">db.createUser(&#123;user: <span class="string">"hsianglee"</span>,<span class="built_in">pwd</span>: <span class="string">"123"</span>,roles: [&#123;role: <span class="string">"readWrite"</span>,db: <span class="string">"test"</span>&#125;]&#125;)</span><br></pre></td></tr></table></figure><p><strong>5. mongodb.config内容修改</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dbpath=F:\mongodb\data\db --auth</span><br><span class="line">logpath=F:\mongodb\data\<span class="built_in">log</span>\mongodb.log</span><br></pre></td></tr></table></figure><p><strong>6. 重启服务</strong></p><p><code>mongodb.exe --dbpath F:\mongodb\data\db --auth</code></p><p><strong>7. node连接</strong></p><p><code>mongodb://root:123@127.0.0.1:27017/test</code></p><p><strong>8. 其它命令</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.system.users.find()          <span class="comment"># 查询已添加用户（切换到admin）</span></span><br><span class="line">db.auth(<span class="string">"root"</span>,<span class="string">"123"</span>)           <span class="comment"># 登录认证</span></span><br><span class="line">db.dropUser(<span class="string">"lee"</span>)              <span class="comment"># 删除用户（先切换到当前数据库）</span></span><br><span class="line">db.updateUser(<span class="string">"test"</span>,&#123;user: <span class="string">""</span>,<span class="built_in">pwd</span>: <span class="string">""</span>, roles: [&#123;role: <span class="string">"read"</span>,db: <span class="string">"test"</span>&#125;]&#125;)    <span class="comment"># 修改权限</span></span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&lt;strong&gt;1. 切换到admin数据库&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;use admin&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;stro
      
    
    </summary>
    
      <category term="mongodb" scheme="https://hsianglee.cn/categories/mongodb/"/>
    
    
      <category term="mongodb" scheme="https://hsianglee.cn/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>回忆录</title>
    <link href="https://hsianglee.cn/2017/10/09/essay/%E5%9B%9E%E5%BF%86%E5%BD%95/"/>
    <id>https://hsianglee.cn/2017/10/09/essay/回忆录/</id>
    <published>2017-10-09T14:25:36.000Z</published>
    <updated>2019-02-18T01:39:58.173Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --><p style="text-indent:2em">相识以来九年有余，初识为汝之惊艳，汝为班长，查吾之英语。犹记之试之，吾以一纸求助于汝，汝视之弃之于娄，转而书纸助汝身后之人，时心塞之。</p><p style="text-indent:2em">本以与汝再无交集，却怎料初三之末，师令吾移位于汝桌之后，吾寡言，汝却擅谈，故相聊甚欢，以至于常于课传纸之于汝。未在校时，常以信聊，一日，接汝之电话，欣喜不已，然却为汝之母，以吾误汝之，批吾训吾。</p><p style="text-indent:2em">汝偶至吾之租舍旁，欣喜未言，因友亦喜于汝，视友与汝同食一桌，亦喜亦忧。</p><p style="text-indent:2em">本以为毕业之后亦无瓜葛，却于前夕于吾之抽屉视一本，字迹似汝，本上几言吾却误之，汝予吾之照片亦存于此。而后假期两月有余，常聊于扣。吾非善熬夜之人，汝却是，常聊至夜半时，然今非兮。</p><p style="text-indent:2em">而后至高中，同校邻班，却未敢寻汝，亦记时逢考试，汝于吾班，留一纸，主体却只一字，吾亦误之。后汝知吾常于自习之后步于操场，汝云减肥，故同步，谓吾于汝班旁候汝，亦喜。未几，汝以众口弃步，吾亦弃之。尔后愈惧汝，遇之未敢视，话之未敢答，只一笑于汝。汝以一纸信问吾何故，吾亦不知，终未答。</p><p style="text-indent:2em">后闻汝有友已半年有余，亦不知为何言，彻夜难眠，未敢再见。于网识一友，谓之以佳，其云乎天鹅湖边鸟飞绝，寒山寺上一棵竹，吾遂谎之删之，此为吾之错耳。</p><p style="text-indent:2em">倏而汝云分之，亦喜亦忧，复往昔。一日，室友知汝于桥边，怂吾寻汝，未敢，其人去往，吾亦随之，然未至之时，其先吾而跑，未曾追，不知以何谓汝，遂弃而游于河边，压抑甚久，见圆月以抒怀。然汝电话于吾，令吾往之，思虑再三终至。吾知其人助吾白于汝，或因卑，或因尊，或因不知何为恋，终未敢言丝毫。</p><p style="text-indent:2em">高三末时，闻人白于汝，汝拒之，甚喜甚忧。本于试后白之。后汝常寻吾，吾亦之，然至今未知汝此为何意，汝常以数学问吾，令吾送之至汝班，数日之后汝即有友，而汝友之数学胜之于吾。初视汝与汝友同于伞，入茶店，未曾信，后登汝之扣视其言语问于汝，方知晚矣。</p><p style="text-indent:2em">时至今汝与之分合数次，然吾亦一人也，虽偶梦汝归，知其间阂之深已非过往，期年未见早已不知汝之喜忧，终是缘而无份。</p><p><img data-original="/images/回忆录/1.jpg" class="lazy" style="margin:0 auto" alt="回忆录"></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Sat Mar 09 2019 10:56:12 GMT+0800 (GMT+08:00) --&gt;&lt;p style=&quot;text-indent:2em&quot;&gt;相识以来九年有余，初识为汝之惊艳，汝为班长，查吾之英语。犹记之试之，吾以一纸求助于汝，汝视之弃之
      
    
    </summary>
    
      <category term="兮词" scheme="https://hsianglee.cn/categories/%E5%85%AE%E8%AF%8D/"/>
    
    
      <category term="兮词" scheme="https://hsianglee.cn/tags/%E5%85%AE%E8%AF%8D/"/>
    
  </entry>
  
</feed>
